<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API URL Test</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; }
        .test-section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        button { background: #007bff; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .result { margin-top: 15px; padding: 15px; border-radius: 4px; white-space: pre-wrap; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üîç API URL Test</h1>
    <p>This will help us identify what URLs the frontend is actually calling.</p>

    <div class="test-section">
        <h3>Test 1: Current Domain API Call</h3>
        <p>This should call the API on the same domain as this page.</p>
        <button onclick="testCurrentDomain()">üöÄ Test Current Domain API</button>
        <div id="result1" class="result info">Click the button to test...</div>
    </div>

    <div class="test-section">
        <h3>Test 2: Relative API Call</h3>
        <p>This uses the same relative path as the frontend app.</p>
        <button onclick="testRelativeAPI()">üöÄ Test Relative API</button>
        <div id="result2" class="result info">Click the button to test...</div>
    </div>

    <div class="test-section">
        <h3>Test 3: Check Current Location</h3>
        <p>This shows where we are and what URLs we're working with.</p>
        <button onclick="checkLocation()">üìç Check Location</button>
        <div id="result3" class="result info">Click the button to check...</div>
    </div>

    <script>
        function testCurrentDomain() {
            const resultDiv = document.getElementById('result1');
            resultDiv.innerHTML = '<div class="result info">üîÑ Testing...</div>';
            
            const currentDomain = window.location.origin;
            const apiUrl = `${currentDomain}/api/auth?action=login`;
            
            console.log('Testing API call to:', apiUrl);
            
            fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: 'test@example.com',
                    password: 'test123456'
                })
            })
            .then(response => response.json())
            .then(data => {
                resultDiv.innerHTML = `
                    <div class="result success">
                        ‚úÖ SUCCESS - API call to: ${apiUrl}
                        <br>Response: ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            })
            .catch(error => {
                resultDiv.innerHTML = `
                    <div class="result error">
                        ‚ùå ERROR - API call to: ${apiUrl}
                        <br>Error: ${error.message}
                    </div>
                `;
            });
        }

        function testRelativeAPI() {
            const resultDiv = document.getElementById('result2');
            resultDiv.innerHTML = '<div class="result info">üîÑ Testing...</div>';
            
            const apiUrl = '/api/auth?action=login';
            
            console.log('Testing relative API call to:', apiUrl);
            
            fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email: 'test@example.com',
                    password: 'test123456'
                })
            })
            .then(response => response.json())
            .then(data => {
                resultDiv.innerHTML = `
                    <div class="result success">
                        ‚úÖ SUCCESS - Relative API call to: ${apiUrl}
                        <br>Response: ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            })
            .catch(error => {
                resultDiv.innerHTML = `
                    <div class="result error">
                        ‚ùå ERROR - Relative API call to: ${apiUrl}
                        <br>Error: ${error.message}
                    </div>
                `;
            });
        }

        function checkLocation() {
            const resultDiv = document.getElementById('result3');
            
            const info = {
                currentURL: window.location.href,
                origin: window.location.origin,
                pathname: window.location.pathname,
                search: window.location.search,
                hash: window.location.hash,
                fullDomain: window.location.hostname,
                protocol: window.location.protocol
            };
            
            resultDiv.innerHTML = `
                <div class="result info">
                    üìç LOCATION INFO:
                    <br>Current URL: ${info.currentURL}
                    <br>Origin: ${info.origin}
                    <br>Pathname: ${info.pathname}
                    <br>Domain: ${info.fullDomain}
                    <br>Protocol: ${info.protocol}
                </div>
            `;
        }

        // Auto-check location on page load
        window.onload = function() {
            checkLocation();
        };
    </script>
</body>
</html>
